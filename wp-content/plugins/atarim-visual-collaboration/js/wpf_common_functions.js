var user_icon = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="166.5px" viewBox="0 0 200 166.5" enable-background="new 0 0 200 166.5" xml:space="preserve"> <path fill="none" stroke="#4B5668" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M141.4,158.021V141.46 c0-18.29-14.83-33.119-33.12-33.119H42.04c-18.292,0-33.121,14.829-33.121,33.119v16.561"/> <circle fill="none" stroke="#4B5668" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" cx="75.16" cy="42.099" r="33.12"/> <path fill="none" stroke="#4B5668" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M191.082,158.021V141.46 c-0.018-15.088-10.221-28.269-24.841-32.044"/> <path fill="none" stroke="#4B5668" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M133.122,10.054 c17.723,4.54,28.413,22.581,23.869,40.301c-2.993,11.725-12.146,20.875-23.869,23.87"/> </svg>';
var screen_short_icon = '<svg enable-background="new 0 0 24 24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#4B5668" d="M21 23h-18c-1.654 0-3-1.346-3-3v-12c0-1.654 1.346-3 3-3 .853 0 1.619-.474 2-1.236l.211-.422c.722-1.445 2.174-2.342 3.789-2.342h6c1.615 0 3.067.897 3.789 2.342l.211.422c.381.762 1.147 1.236 2 1.236 1.654 0 3 1.346 3 3v12c0 1.654-1.346 3-3 3zm-12-20c-.853 0-1.619.474-2 1.236l-.211.422c-.722 1.445-2.174 2.342-3.789 2.342-.551 0-1 .449-1 1v12c0 .552.449 1 1 1h18c.552 0 1-.448 1-1v-12c0-.551-.448-1-1-1-1.615 0-3.067-.897-3.789-2.342l-.211-.422c-.381-.762-1.147-1.236-2-1.236h-6zm3 16c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zm0-10c-2.206 0-4 1.794-4 4s1.794 4 4 4 4-1.794 4-4-1.794-4-4-4z"/></svg>';
var share_icon = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="195px" viewBox="0 0 200 195" enable-background="new 0 0 200 195" xml:space="preserve"> <path fill="#4B5668" d="M128.002,174.893c-25.824,10.856-55.761,5.63-76.456-13.409c17.481-18.517,4.467-49.346-21.274-49.346 C14.131,112.138,1,125.27,1,141.411c0,19.861,19.495,34.034,38.408,27.805c24.83,24.902,62.124,31.979,94.016,18.573 c3.56-1.496,5.234-5.598,3.735-9.16C135.664,175.069,131.564,173.396,128.002,174.893L128.002,174.893z M14.989,141.411 c0-8.427,6.855-15.283,15.283-15.283c8.426,0,15.282,6.856,15.282,15.283s-6.855,15.282-15.282,15.282 C21.845,156.693,14.989,149.838,14.989,141.411z"/> <path fill="#4B5668" d="M23.708,88.273c3.644,1.325,7.648-0.566,8.965-4.181C39.639,64.94,54.739,49.47,73.56,41.929 c4.619,10.106,14.815,17.149,26.632,17.149c16.14,0,29.272-13.131,29.272-29.272c0-16.14-13.132-29.271-29.272-29.271 c-15.512,0-28.238,12.132-29.205,27.404c-23.95,8.684-42.817,27.608-51.461,51.371C18.206,82.939,20.077,86.953,23.708,88.273 L23.708,88.273z M100.193,14.523c8.426,0,15.281,6.855,15.281,15.282s-6.854,15.283-15.281,15.283 c-8.428,0-15.283-6.855-15.283-15.283C84.911,21.378,91.766,14.523,100.193,14.523z"/> <path fill="#4B5668" d="M185.615,116.597c0.248-1.387,0.393-5.853,0.393-7.949c0-24.25-10.332-47.48-28.349-63.734 c-2.868-2.587-7.29-2.36-9.879,0.508c-2.588,2.868-2.361,7.291,0.508,9.879c15.778,14.234,24.703,35.034,23.641,56.899 c-17.003-1.046-31.086,12.519-31.086,29.212c0,16.14,13.13,29.271,29.271,29.271c16.142,0,29.272-13.132,29.272-29.271 C199.386,130.96,193.877,121.776,185.615,116.597L185.615,116.597z M170.112,156.693c-8.425,0-15.281-6.855-15.281-15.282 c0-8.428,6.856-15.284,15.281-15.284c8.429,0,15.282,6.856,15.282,15.284C185.396,149.838,178.541,156.693,170.112,156.693z"/> </svg>';
var status_icon = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="110.836px" viewBox="0 0 200 110.836" enable-background="new 0 0 200 110.836" xml:space="preserve"> <g> <path fill="#4B5668" stroke="#FFFFFF" stroke-width="3" stroke-miterlimit="10" d="M96.199,84.264 c3.212-8.122,5.887-14.854,8.54-21.596c6.955-17.673,14.016-35.305,20.766-53.054c1.697-4.463,3.078-8.703,8.865-8.447 c5.82,0.257,7.804,4.332,9.179,9.283c4.447,16.01,9.085,31.967,13.669,47.941c0.518,1.799,1.149,3.571,1.829,5.669 c10.653,0,21.103,0.078,31.551-0.034c5.134-0.054,9.407,1.354,9.421,7.142c0.014,5.783-4.243,7.199-9.379,7.208 c-12.833,0.021-25.67,0.222-38.504,0.363c-5.496,0.062-7.919-3.141-9.272-8.057c-3.298-11.993-6.843-23.916-10.682-37.219 c-1.465,2.919-2.413,4.478-3.063,6.153c-8.467,21.917-16.763,43.902-25.501,65.708c-1.02,2.545-4.559,5.876-6.71,5.726 c-2.753-0.194-6.52-3-7.705-5.638c-7.184-16.025-13.744-32.325-20.544-48.52c-0.972-2.317-2.113-4.565-3.642-7.844 c-4.028,8.057-7.796,15.156-11.148,22.445c-2.247,4.89-5.341,7.185-11.01,6.967c-10.686-0.407-21.399-0.201-32.1-0.085 c-5.209,0.056-10.13-0.729-10.255-7.028c-0.124-6.294,4.633-7.399,9.939-7.321c8.323,0.124,16.667-0.326,24.963,0.168 c4.906,0.292,7.171-1.588,9.085-5.808c4.018-8.863,8.283-17.642,13.061-26.11c1.543-2.737,5.344-6.432,7.502-6.07 c3.262,0.548,7.29,3.667,8.725,6.747c6.71,14.412,12.632,29.188,18.867,43.823C93.527,78.845,94.57,80.845,96.199,84.264z"/> </g> </svg>';
var priority_icon = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"> <path fill="#4B5668" d="M197.058,61.695L157.311,5.664c-2.004-2.826-5.271-4.514-8.736-4.515c-0.002,0-0.002,0-0.002,0 c-3.467,0-6.733,1.687-8.738,4.515l-39.747,56.032c-2.328,3.281-2.628,7.542-0.781,11.118c1.847,3.575,5.496,5.796,9.52,5.796 h16.558v108.869c0,6.141,4.994,11.135,11.135,11.135h24.106c6.141,0,11.136-4.995,11.136-11.135V78.609h16.558 c4.024,0,7.671-2.222,9.519-5.796C199.683,69.237,199.385,64.976,197.058,61.695z M164.363,63.817c-4.087,0-7.396,3.311-7.396,7.396 v112.61h-16.794V71.214c0-4.086-3.31-7.396-7.395-7.396h-16.063l31.854-44.907l31.855,44.907L164.363,63.817L164.363,63.817z"/> <path fill="#4B5668" d="M91.176,121.152h-16.56V12.282c0-6.141-4.994-11.136-11.135-11.136H39.375 c-6.141,0-11.135,4.995-11.135,11.136V52.68c0,4.086,3.31,7.396,7.396,7.396c4.085,0,7.396-3.31,7.396-7.396V15.939h16.792v112.61 c0,4.085,3.31,7.396,7.396,7.396h16.062L51.428,180.85l-31.853-44.905h16.062c4.085,0,7.396-3.311,7.396-7.396V87.077 c0-4.085-3.311-7.395-7.396-7.395c-4.086,0-7.396,3.31-7.396,7.395v34.075H11.683c-4.026,0-7.674,2.222-9.521,5.797 c-1.847,3.576-1.546,7.836,0.782,11.115l39.747,56.032c2.006,2.827,5.272,4.517,8.738,4.517h0.002 c3.468-0.001,6.733-1.691,8.737-4.517l39.746-56.03c2.329-3.281,2.63-7.541,0.782-11.117 C98.848,123.374,95.2,121.152,91.176,121.152L91.176,121.152z"/> </svg>';
var info_icon = '<svg height="100px" version="1.1" viewBox="0 0 100 100" width="100px" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><desc/><defs/><g fill="none" fill-rule="evenodd" id="MiMedia---iOS/Android" stroke="none" stroke-width="1"><g fill="#4B5668" id="icon32pt_info"><path d="M50,94 C74.300529,94 94,74.300529 94,50 C94,25.699471 74.300529,6 50,6 C25.699471,6 6,25.699471 6,50 C6,74.300529 25.699471,94 50,94 L50,94 Z M50,86 C69.882251,86 86,69.882251 86,50 C86,30.117749 69.882251,14 50,14 C30.117749,14 14,30.117749 14,50 C14,69.882251 30.117749,86 50,86 L50,86 Z M45,49.0044356 C45,46.2405621 47.2441952,44 50,44 C52.7614237,44 55,46.2303666 55,49.0044356 L55,68.9955644 C55,71.7594379 52.7558048,74 50,74 C47.2385763,74 45,71.7696334 45,68.9955644 L45,49.0044356 L45,49.0044356 Z M44,32 C44,28.6862915 46.6930342,26 50,26 C53.3137085,26 56,28.6930342 56,32 C56,35.3137085 53.3069658,38 50,38 C46.6862915,38 44,35.3069658 44,32 L44,32 Z" id="Oval-58"/></g></g></svg>';
var image_download_icon = '<svg viewBox="0 0 512 512" id="ion-android-download" width="18" height="18" fill="#fff"><path d="M403.002 217.001C388.998 148.002 328.998 96 256 96c-57.998 0-107.998 32.998-132.998 81.001C63.002 183.002 16 233.998 16 296c0 65.996 53.999 120 120 120h260c55 0 100-45 100-100 0-52.998-40.996-96.001-92.998-98.999zM224 268v-76h64v76h68L256 368 156 268h68z"></path></svg>';
var push_to_media_icon='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="31px" viewBox="0 0 32 31" version="1.1">';
push_to_media_icon += '<g id="surface1"><path style=" stroke:none;fill-rule:nonzero;fill:#ffffff;fill-opacity:1;" d="M 16.234375 16.746094 L 13.558594 24.3125 L 13.550781 24.3125 L 11.476562 30.09375 C 11.621094 30.132812 11.761719 30.164062 11.910156 30.203125 C 11.917969 30.203125 11.925781 30.203125 11.933594 30.203125 C 13.222656 30.535156 14.578125 30.71875 15.972656 30.71875 C 16.667969 30.71875 17.34375 30.679688 18.007812 30.574219 C 18.921875 30.464844 19.800781 30.277344 20.660156 30.015625 C 20.871094 29.953125 21.082031 29.878906 21.296875 29.808594 C 21.066406 29.335938 20.578125 28.28125 20.554688 28.234375 Z M 16.234375 16.746094 "/>';
push_to_media_icon += '<path style=" stroke:none;fill-rule:nonzero;fill:#ffffff;fill-opacity:1;" d="M 1.6875 9.5625 C 0.871094 11.351562 0.316406 13.550781 0.316406 15.535156 C 0.316406 16.03125 0.339844 16.53125 0.390625 17.019531 C 0.953125 22.652344 4.707031 27.382812 9.867188 29.507812 C 10.078125 29.59375 10.300781 29.683594 10.519531 29.761719 L 2.929688 9.570312 C 2.277344 9.546875 2.152344 9.585938 1.6875 9.5625 Z M 1.6875 9.5625 "/>';
push_to_media_icon += '<path style=" stroke:none;fill-rule:nonzero;fill:#ffffff;fill-opacity:1;" d="M 30.210938 9.160156 C 29.859375 8.425781 29.441406 7.722656 28.976562 7.058594 C 28.847656 6.867188 28.699219 6.675781 28.5625 6.488281 C 26.804688 4.210938 24.414062 2.421875 21.628906 1.378906 C 19.882812 0.714844 17.972656 0.351562 15.980469 0.351562 C 11.058594 0.351562 6.660156 2.566406 3.785156 6.019531 C 3.253906 6.652344 2.78125 7.332031 2.355469 8.046875 C 3.515625 8.054688 4.953125 8.054688 5.117188 8.054688 C 6.59375 8.054688 8.871094 7.878906 8.871094 7.878906 C 9.640625 7.832031 9.71875 8.914062 8.960938 9.003906 C 8.960938 9.003906 8.195312 9.089844 7.34375 9.128906 L 12.480469 23.917969 L 15.566406 14.957031 L 13.378906 9.136719 C 12.609375 9.097656 11.898438 9.011719 11.898438 9.011719 C 11.132812 8.972656 11.230469 7.839844 11.980469 7.886719 C 11.980469 7.886719 14.308594 8.0625 15.695312 8.0625 C 17.171875 8.0625 19.453125 7.886719 19.453125 7.886719 C 20.210938 7.839844 20.308594 8.921875 19.539062 9.011719 C 19.539062 9.011719 18.78125 9.097656 17.933594 9.136719 L 23.019531 23.816406 L 24.429688 19.257812 C 25.140625 17.488281 25.5 16.023438 25.5 14.855469 C 25.5 13.171875 24.871094 12 24.332031 11.089844 C 23.621094 9.960938 22.953125 9.011719 22.953125 7.894531 C 22.953125 6.636719 23.933594 5.46875 25.320312 5.46875 C 25.378906 5.46875 25.441406 5.46875 25.5 5.46875 C 27.640625 5.414062 28.339844 7.46875 28.429688 8.867188 C 28.429688 8.867188 28.429688 8.898438 28.429688 8.914062 C 28.464844 9.484375 28.4375 9.902344 28.4375 10.402344 C 28.4375 11.777344 28.167969 13.335938 27.371094 15.289062 L 24.1875 24.210938 L 22.367188 29.40625 C 22.511719 29.34375 22.652344 29.277344 22.796875 29.207031 C 27.425781 27.042969 30.796875 22.722656 31.507812 17.605469 C 31.613281 16.933594 31.664062 16.246094 31.664062 15.550781 C 31.664062 13.265625 31.140625 11.097656 30.210938 9.160156 Z M 30.210938 9.160156 "/>';
push_to_media_icon += '</g></svg>';
var image_close_icon = '<svg data-v-07452373="" height="18" width="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x feather__content"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
var image_external_icon = '<svg version="1.1" height="18" width="18" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="511.626px" height="511.627px" viewBox="0 0 511.626 511.627" style="enable-background:new 0 0 511.626 511.627;" xml:space="preserve"> <g> <g> <path d="M392.857,292.354h-18.274c-2.669,0-4.859,0.855-6.563,2.573c-1.718,1.708-2.573,3.897-2.573,6.563v91.361 c0,12.563-4.47,23.315-13.415,32.262c-8.945,8.945-19.701,13.414-32.264,13.414H82.224c-12.562,0-23.317-4.469-32.264-13.414 c-8.945-8.946-13.417-19.698-13.417-32.262V155.31c0-12.562,4.471-23.313,13.417-32.259c8.947-8.947,19.702-13.418,32.264-13.418 h200.994c2.669,0,4.859-0.859,6.57-2.57c1.711-1.713,2.566-3.9,2.566-6.567V82.221c0-2.662-0.855-4.853-2.566-6.563 c-1.711-1.713-3.901-2.568-6.57-2.568H82.224c-22.648,0-42.016,8.042-58.102,24.125C8.042,113.297,0,132.665,0,155.313v237.542 c0,22.647,8.042,42.018,24.123,58.095c16.086,16.084,35.454,24.13,58.102,24.13h237.543c22.647,0,42.017-8.046,58.101-24.13 c16.085-16.077,24.127-35.447,24.127-58.095v-91.358c0-2.669-0.856-4.859-2.574-6.57 C397.709,293.209,395.519,292.354,392.857,292.354z"/> <path d="M506.199,41.971c-3.617-3.617-7.905-5.424-12.85-5.424H347.171c-4.948,0-9.233,1.807-12.847,5.424 c-3.617,3.615-5.428,7.898-5.428,12.847s1.811,9.233,5.428,12.85l50.247,50.248L198.424,304.067 c-1.906,1.903-2.856,4.093-2.856,6.563c0,2.479,0.953,4.668,2.856,6.571l32.548,32.544c1.903,1.903,4.093,2.852,6.567,2.852 s4.665-0.948,6.567-2.852l186.148-186.148l50.251,50.248c3.614,3.617,7.898,5.426,12.847,5.426s9.233-1.809,12.851-5.426 c3.617-3.616,5.424-7.898,5.424-12.847V54.818C511.626,49.866,509.813,45.586,506.199,41.971z"/> </g> </g> </svg>';
var image_open_icon = '<svg height="18px" version="1.1" viewBox="0 0 100 100" width="18px" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><desc/><defs/><g fill="none" fill-rule="evenodd" id="MiMedia---Web" stroke="none" stroke-width="1"><g fill="#fff" id="icon24pt_new_window" transform="translate(2.000000, 2.000000)"><path d="M73.7883228,16 L44.56401,45.2243128 C42.8484762,46.9398466 42.8459918,49.728257 44.5642987,51.4465639 C46.2791092,53.1613744 49.0684023,53.1650001 50.7865498,51.4468526 L80,22.2334024 L80,32.0031611 C80,34.2058797 81.790861,36 84,36 C86.2046438,36 88,34.2105543 88,32.0031611 L88,11.9968389 C88,10.8960049 87.5527117,9.89722307 86.8294627,9.17343595 C86.1051125,8.44841019 85.1063303,8 84.0031611,8 L63.9968389,8 C61.7941203,8 60,9.790861 60,12 C60,14.2046438 61.7894457,16 63.9968389,16 L73.7883228,16 L73.7883228,16 Z M88,56 L88,36.9851507 L88,78.0296986 C88,83.536144 84.0327876,88 79.1329365,88 L16.8670635,88 C11.9699196,88 8,83.5274312 8,78.0296986 L8,17.9703014 C8,12.463856 11.9672124,8 16.8670635,8 L59.5664682,8 L40,8 C42.209139,8 44,9.790861 44,12 C44,14.209139 42.209139,16 40,16 L18.2777939,16 C17.0052872,16 16,17.1947367 16,18.668519 L16,77.331481 C16,78.7786636 17.0198031,80 18.2777939,80 L77.7222061,80 C78.9947128,80 80,78.8052633 80,77.331481 L80,56 C80,53.790861 81.790861,52 84,52 C86.209139,52 88,53.790861 88,56 L88,56 Z" id="Rectangle-2064"/></g></g></svg>';

const milestone_clock_icon            = '<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.07 1.01h-6v2h6v-2zm-4 13h2v-6h-2v6zm8.03-6.62l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42A8.962 8.962 0 0012.07 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.11-.74-4.06-1.97-5.61zm-7.03 12.62c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path></svg>';
const milestone_calender_icon         = '<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2V2h-2v2H9V2H7v2H5a2 2 0 0 0-2 2zm16 14H5V8h14z"></path></svg>';
const milestone_calender_check_icon   = '<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 4h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm.002 16H5V8h14l.002 12z"></path><path d="m11 17.414 5.707-5.707-1.414-1.414L11 14.586l-2.293-2.293-1.414 1.414z"></path></svg>';
const milestone_calender_plus_icon    = '<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15h3v3h2v-3h3v-2h-3v-3h-2v3H8z"></path><path d="M19 4h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm.002 16H5V8h14l.002 12z"></path></svg>';

function wpf_confirm(title, msg, ttrue, ffalse, temp_funct) {
    var $content =  "<div class='wpf_confirm_dialog_overlay'>" +
        "<div class='wpf_confirm_dialog'><header>" +
        " <h3> " + title + " </h3> " +
        "<i class='wpf-close'>X</i>" +
        "</header>" +
        "<div class='wpf_confirm_dialog_msg'>" +
        " <p> " + msg + " </p> " +
        "</div>" +
        "<footer>" +
        "<div class='wpf_confirm_dialog_controls'>" +
        " <button class='wpf_confirm_yes'>" + ttrue + "</button> " +
        " <button class='wpf_confirm_cancle'>" + ffalse + "</button> " +
        "</div>" +
        "</footer>" +
        "</div>" +
        "</div>";
    jQuery_WPF('body').prepend($content);
    jQuery_WPF('.wpf_confirm_yes').click(function () {
        jQuery_WPF(this).parents('.wpf_confirm_dialog_overlay').fadeOut(500, function () {
            jQuery_WPF(this).remove();
        });
        window[temp_funct]();
        return true;
    });
    jQuery_WPF('.wpf_confirm_cancle, .wpf-close').click(function () {
        jQuery_WPF(this).parents('.wpf_confirm_dialog_overlay').fadeOut(500, function () {
            jQuery_WPF(this).remove();
        });
        return false;
    });
}

/**
 * Get the URL parameters
 *
 * @param  {String} url The URL
 * @return {Object}     The URL parameters
 */
const getParams = function (url) {
    var params = {};
    var parser = document.createElement('a');
    parser.href = url;
    var query = parser.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        params[pair[0]] = decodeURIComponent(pair[1]);
    }
    return params;
};

/*
*keep graphics sidebar active
*/

function graphics_sidebar_active(){
    jQuery_WPF('body.wpf_graphics .wpf_sidebar_container').addClass('active');
    jQuery_WPF('body.wpf_graphics .wpf_sidebar_container').css({"display": "inline-block","opacity": "1","margin-right": "", "height":"calc(100vh - 32px) !important","position":"","top":""});
}

function expand_sidebar(){
    if(jQuery_WPF('#wpf_launcher .wpf_sidebar_container').hasClass('active')) {

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').css({"opacity": "0","margin-right": "-380px"});

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').removeClass('active');

        if(jQuery_WPF('a.wpf_filter_tab_btn_bottom.wpf_btm_withside').hasClass('wpf_active')){
            jQuery_WPF('.wpf_list').removeClass('wpf_active').addClass('wpf_hide');
            jQuery_WPF('a.wpf_filter_tab_btn_bottom.wpf_btm_withside').removeClass('wpf_active');

            //graphics page
            graphics_sidebar_active();
        }
    } else {
        var wpf_tmp_show_task_checkbox_obj = jQuery_WPF("#wpfb_display_tasks");
        if(wpf_tmp_show_task_checkbox_obj.prop('checked')==false){
            wpf_tmp_show_task_checkbox_obj.prop('checked',true);
        }
        wpf_display_tasks(wpf_tmp_show_task_checkbox_obj);

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').css({"display": "inline-block","opacity": "1","margin-right": "","position":"inherit","top":"32px"});
        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').addClass('active');

        //graphics page
        graphics_sidebar_active();
    }
}

function expand_menubar() {
    if( jQuery_WPF('#wpf_launcher .avc_menu_wrapper').hasClass('active')) {
        jQuery_WPF('#wpf_launcher .avc_menu_wrapper').css({"opacity": "0","left": "-72px"});
        jQuery_WPF('#wpf_launcher .avc_menu_wrapper').removeClass('active');
    } else {
        jQuery_WPF('#wpf_launcher .avc_menu_wrapper').css({"opacity": "1","left": "0px"});
        jQuery_WPF('#wpf_launcher .avc_menu_wrapper').addClass('active');
    }
}


/**
 * Expand when compact mode is on
 */
function expand_compact_sidebar(){
    if(jQuery_WPF('#wpf_launcher .wpf_sidebar_container').hasClass('active')) {

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').css({"opacity": "0","margin-right": "-380px"});

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').removeClass('active');
    } else {
        var wpf_tmp_show_task_checkbox_obj = jQuery_WPF("#wpfb_display_tasks");
        if(wpf_tmp_show_task_checkbox_obj.prop('checked')==false){
            wpf_tmp_show_task_checkbox_obj.prop('checked',true);
        }
        wpf_display_tasks(wpf_tmp_show_task_checkbox_obj);

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').css({"display": "inline-block","opacity": "1","margin-right": ""});

        jQuery_WPF('#wpf_launcher .wpf_sidebar_container').addClass('active');
    }
}

/*
 * used to toggle bottom task panel
 */

function expand_bottom_bar(){
    var is_expand = '1';
    if(jQuery_WPF('#wpf_launcher #wpf_bottom_bar').hasClass('active')) { // hide the panel
	    is_expand = '0';
	
	    jQuery_WPF('#wpf_launcher .wpf_launch_buttons').css({"bottom":"5px"});
        jQuery_WPF('#wpf_launcher #wpf_bottom_bar').css({"bottom": "-60px"});

        jQuery_WPF('#wpf_launcher #wpf_bottom_bar').removeClass('active');
        if(jQuery_WPF('#wpf_launcher .wpf_sidebar_container').hasClass('active')) {
            expand_sidebar();
        }
    } else { // show the panel
	
	    jQuery_WPF('#wpf_launcher .wpf_launch_buttons').css({"bottom":"-60px"});
        jQuery_WPF('#wpf_launcher #wpf_bottom_bar').css({"bottom": "0"});
        jQuery_WPF('#wpf_launcher #wpf_bottom_bar').addClass('active');
    }
    
    jQuery_WPF.ajax({
        method:"POST",
        url: ajaxurl,
        data: {action:'bottom_panel_session',wpf_nonce:wpf_nonce, is_expand: is_expand},
        success: function(data){
	    
	}
    });
}

// status prioty bottom bar filter
jQuery_WPF(document).ready(function(){
    jQuery_WPF('a.wpf_filter_tab_btn_bottom').click(function(event){
        if(jQuery_WPF(this).hasClass('wpf_active')){
            jQuery_WPF('a.wpf_filter_tab_btn_bottom').removeClass('wpf_active');
            jQuery_WPF(this).removeClass('wpf_active');
            jQuery_WPF('.wpf_list').removeClass('wpf_active').addClass('wpf_hide');

            //close sidebar too
            if(jQuery_WPF(this).hasClass('wpf_btm_withside')){                
                //graphics page
                graphics_sidebar_active();
            }

            //graphics page
            graphics_sidebar_active();
        }else{
            // Do not proceed if it is admin and share button is clicked as the share version 2 is active by Pratap.
            if( jQuery_WPF('.avc_invite_share_wrapper').length > 0 && jQuery_WPF(this).data('tag') == 'wpf_share_page_btn') {
                return;
            }
            jQuery_WPF('a.wpf_filter_tab_btn_bottom').removeClass('wpf_active');
            jQuery_WPF(this).addClass('wpf_active');
            var tagid = jQuery_WPF(this).data('tag');
            jQuery_WPF('.wpf_list').removeClass('wpf_active').addClass('wpf_hide');
            jQuery_WPF('#'+tagid).addClass('wpf_active').removeClass('wpf_hide');

            // search expand
            if ( jQuery(this).parent().hasClass('search') ) {
                jQuery('#sidebar_search').addClass('active');
                jQuery_WPF("#wpf_search_title").focus();
            }

            //open sidebar too
            if(jQuery_WPF(this).hasClass('wpf_btm_withside')){
                var wpf_tmp_show_task_checkbox_obj = jQuery_WPF("#wpfb_display_tasks");
                if(wpf_tmp_show_task_checkbox_obj.prop('checked')==false){
                    wpf_tmp_show_task_checkbox_obj.prop('checked',true);
                }
                wpf_display_tasks(wpf_tmp_show_task_checkbox_obj);
                //graphics page
                graphics_sidebar_active();
            }

            //graphics page
            graphics_sidebar_active();
        }
    });
    jQuery_WPF('#wpf_display_all_taskmeta').click(function(){
        if(jQuery_WPF('.wpf_container ul li .wpf_task_meta').hasClass('wpf_active')){
            jQuery_WPF('.wpf_container ul li .wpf_task_meta').removeClass('wpf_active');
        }else{
            jQuery_WPF('.wpf_container ul li .wpf_task_meta').addClass('wpf_active');
        }
    });

});

jQuery_WPF('#confirm_approve_page').on('click',function(){
    let complete_tasks=Number(jQuery_WPF("#wpf_approve_all").is(":checked"))
        jQuery_WPF.ajax({
            url: ajaxurl,
            type: 'POST',
            data: {action:'wpfb_approve_page',wpf_nonce:wpf_nonce,page_id:current_page_id,complete_tasks:complete_tasks,current_user_id:current_user_id},
            beforeSend: function(){
                jQuery_WPF('.wpf_loader_approve_page').show();
            },
            success: function(data){
                jQuery_WPF('.wpf_loader_approve_page').hide();
                if(data == 1){
                    jQuery_WPF('#confirm_approve_page').find('span').html('Approved');
                    jQuery_WPF('#confirm_approve_page').attr('data-is-approve',1);
                    jQuery_WPF('.approve_confirm_modal').hide();
                    jQuery_WPF('.wpf_page_approved').show();
                    if(complete_tasks==1){
                    jQuery_WPF('.popover').hide();
                    jQuery_WPF('#wpf_total_task_number').text('0');
                    jQuery_WPF(".wpfb-point").removeClass('open').removeClass('complete').removeClass('pending-review').removeClass('in-progress').removeClass('complete_custom').removeClass('open_custom').removeClass('pending-review_custom').removeClass('in-progress_custom').addClass('complete complete_custom');
                    jQuery_WPF(".current_page_task").removeClass('open').removeClass('complete').removeClass('pending-review').removeClass('in-progress').removeClass('complete_custom').removeClass('open_custom').removeClass('pending-review_custom').removeClass('in-progress_custom').addClass('complete complete_custom');
                    jQuery_WPF(".current_page_general_task").removeClass('open').removeClass('complete').removeClass('pending-review').removeClass('in-progress').removeClass('complete_custom').removeClass('open_custom').removeClass('pending-review_custom').removeClass('in-progress_custom').addClass('complete complete_custom');
                }
                }else{
                    jQuery_WPF("#approve_error").show().delay(5000).fadeOut();
                }
            }
        });
});

jQuery_WPF('#open_approve_modal').on('click',function(){
    let page_approve = jQuery_WPF('#open_approve_modal').attr('data-is-approve');
    if(page_approve == 0){
        jQuery_WPF('#approve_pg').show();
    }
})
jQuery_WPF('.wpf_approve_pg_close').on('click',function(){
    jQuery_WPF('#approve_pg').hide();
})

jQuery_WPF('#open_responsive_modal').on('click',function(){
        jQuery_WPF('#responsive_modal').show();
})
jQuery_WPF('.wpf_responsive_modal_wrap .wpf_close').click(function(){
    location.reload();
})
function inIframe () {
    try {
        return window.self !== window.top;
    } catch (e) {
        return true;
    }
}
if(inIframe()!=true && !jQuery_WPF('body').hasClass('wpf_graphics') && !jQuery_WPF('body').hasClass('wp-admin')){
    jQuery_WPF(".wpf_responsive_icons_bar").show();
}
jQuery_WPF('.wpf_responsive_icons_bar').on('click', function() {
    if( jQuery_WPF('.wpf_responsove_options').css('visibility') == 'hidden' ) {
        jQuery_WPF('.wpf_responsove_options').css('visibility','visible');
    } else {
        jQuery_WPF('.wpf_responsove_options').css('visibility','hidden');
    }
});
jQuery_WPF('.wpf_visibility_container').on('click', function() {
    if( jQuery_WPF('#wpf_task_visibility').css('display') == 'none' ) {
        jQuery_WPF('#wpf_task_visibility').css('display','flex');
    } else {
        jQuery_WPF('#wpf_task_visibility').css('display','none');
    }
});
jQuery_WPF('.wpf_responsive_desk').on('click',function(){
    jQuery_WPF('.wpf_responsive_icon').removeClass('wpf_responsive_active_tab');
    jQuery_WPF('.wpf_responsive_desk').addClass('wpf_responsive_active_tab');
    jQuery_WPF(".iframe_holder iframe").removeAttr('src');
    jQuery_WPF('.iframe_holder').css('width','calc(80% + 30px )').css('height','calc(80% + 120px)');
    jQuery_WPF('#responsive_modal').show();
    setTimeout(function(){
        jQuery_WPF(".iframe_holder iframe").attr("src",location.href);
    },50);
})
jQuery_WPF('.wpf_responsive_tablet').on('click',function(){
    jQuery_WPF('.wpf_responsive_icon').removeClass('wpf_responsive_active_tab');
    jQuery_WPF('.wpf_responsive_tablet').addClass('wpf_responsive_active_tab');
    jQuery_WPF(".iframe_holder iframe").removeAttr('src');
    jQuery_WPF('.iframe_holder').css('width','1024px').css('height','100vh');
    jQuery_WPF('#responsive_modal').show();
    setTimeout(function(){
        jQuery_WPF(".iframe_holder iframe").attr("src",location.href);
    },50);
})
jQuery_WPF('.wpf_responsive_mobile').on('click',function(){
    jQuery_WPF('.wpf_responsive_icon').removeClass('wpf_responsive_active_tab');
    jQuery_WPF('.wpf_responsive_mobile').addClass('wpf_responsive_active_tab');
    jQuery_WPF(".iframe_holder iframe").removeAttr('src');
    jQuery_WPF('.iframe_holder').css('width','600px').css('height','100vh');
    jQuery_WPF('#responsive_modal').show();
    setTimeout(function(){
        jQuery_WPF(".iframe_holder iframe").attr("src",location.href);
    },50);
})
jQuery_WPF('#wpf_scale_effect').on('change',function(){
    let scale_effect='';
    scale_effect=jQuery_WPF(this).val();
    jQuery_WPF('.iframe_holder').removeClass('wpf_scale_50').removeClass('wpf_scale_75').removeClass('wpf_scale_100').removeClass('wpf_scale_125').removeClass('wpf_scale_150').addClass('wpf_scale_'+scale_effect);
})
jQuery_WPF("#wpfb_display_completed_tasks").change(function() {
    if(this.checked) {
        jQuery_WPF('.wpfb-point').each(function(){
            if(jQuery_WPF(this).hasClass('complete')){
                jQuery_WPF(this).show();
            }
        });
    }
    else{
        jQuery_WPF('.wpfb-point').each(function(){
            if(jQuery_WPF(this).hasClass('complete')){
                jQuery_WPF(this).hide();
            }
        });
    }
});
jQuery_WPF("#wpfb_display_internal_tasks").change(function() {
    if(this.checked) {
        jQuery_WPF('.wpfb-point').each(function(){
            if(jQuery_WPF(this).hasClass('wpfb-internal')){
                jQuery_WPF(this).show();
            }
        });
    }
    else{
        jQuery_WPF('.wpfb-point').each(function(){
            if(jQuery_WPF(this).hasClass('wpfb-internal')){
                jQuery_WPF(this).hide();
            }
        });
    }
});
jQuery_WPF("#wpfb_display_tasks").change(function() {
    wpf_display_tasks(this);
});

function wpf_display_tasks(obj) {
    if(document.getElementById('wpfb_display_tasks').checked) {
        jQuery_WPF('.wpfb-point').each(function(){

            // First it will check if the task is completed or not by inspecting the class
            // If completed class has present then it will check if "Show Completed" checkbox has checked or not
            // If not checked, then it will hide it otherwise it will show the task => v2.1.1.
            if ( jQuery_WPF(this).hasClass('complete') && (!jQuery_WPF('#wpfb_display_completed_tasks').is(':checked')) ) {
                jQuery_WPF(this).hide();
            } else {
                jQuery_WPF(this).show();
            }
        });
    }
    else{
        jQuery_WPF('.wpfb-point').each(function(){
            jQuery_WPF(this).hide();
        });
    }
}

function wpf_remove_login_to_clipboard_sidebar(){
    const params = getParams(window.location.href);
    if(document.getElementById('wpf_remove_login_task_link').checked) {
        var task_link =  (window.location.href.lastIndexOf('graphic/?id') > 0 ) ? current_page_url+ '?id=' + params['id']
            : current_page_url;
        jQuery_WPF(document).find('#wpf_share_page_link').val(task_link);
        jQuery_WPF(document).find('.wpf_task_link').text(task_link);
    }else{
        var task_link =  (window.location.href.lastIndexOf('graphic/?id') > 0 ) ? current_page_url+ '?id=' + params['id'] + '&wpf_login=1'
            : current_page_url + '?wpf_login=1';
        jQuery_WPF(document).find('#wpf_share_page_link').val(task_link);
        jQuery_WPF(document).find('.wpf_task_link').text(task_link);
    }
}

function wpf_copy_to_clipboard(id) {
    var copyText = document.getElementById(id);
    copyText.select();
    copyText.setSelectionRange(0, 99999);
    document.execCommand("copy");

    jQuery_WPF('#wpf_success_'+id).show();
    setTimeout(function() {
        jQuery_WPF('#wpf_success_'+id).fadeOut();
    }, 500);

    return false;
}

function wpf_image_open_new_tab(e){
    jQuery_WPF(e).parent().find('a')[0].click();
}

function wpf_task_image_delete(e){
    var task_img_url = jQuery_WPF(e).parent().find('a')[0].getAttribute('href');
    var comment_li = jQuery_WPF(e).closest('li');
    var comment_id = comment_li.data('comment_id');
    jQuery_WPF.ajax({
        type: 'POST',
        url: ajaxurl,
        data : {action: "wpfb_delete_task_image",wpf_nonce:wpf_nonce,task_img_url:task_img_url,comment_id:comment_id},
        beforeSend: function (){
        },
        success: function(data){
            if(data == 1){
                comment_li.remove();
            }
        }
    });
}

function wpf_image_download_action(){
    let anchor = jQuery_WPF('#wpf_image_download').parent().find('a')[0];
    var anchorTag = document.createElement('a');
    anchorTag.href = jQuery_WPF(anchor).attr('href');
    anchorTag.download = "download";
    anchorTag.target = "_blank";
    anchorTag.click();
    var element = document.getElementById('wpf_image_download');
    element.appendChild(anchorTag);
    anchorTag.remove();
}
function search_filter(task_title) {

    const $sidebar = jQuery(".wpf_sidebar_container");
    let active_tab = jQuery_WPF("#wpf_thispage");
    let count = 0;

    $sidebar.find('.wpf_container').each(function(index, element) {

        if ( jQuery(element).hasClass('wpf_active_filter') ) {
            active_tab = jQuery("#" + jQuery(element).attr('id'));
        }
    });

    jQuery(active_tab).find('ul > li').each(function(index, element) {

        if ( jQuery(element).find('.current_page_task_list').text().toLowerCase().includes(task_title.toLowerCase()) ) {
            jQuery_WPF('.wpf_sidebar_content').removeClass('nothingfound');
            jQuery(element).show();
        } else {
            jQuery(element).hide();
            count++;
        }
    });

    if ( jQuery(active_tab).find('ul > li').length === count ) {
        jQuery_WPF('.wpf_sidebar_content').addClass('nothingfound');
    }
}


/**
 * Search filter tasks on the sidebar
 *
 * @param element
 */
function wp_feedback_cat_filter(event, element) {
    var task_types = [];
    const task_title = jQuery('#wpf_search_title').val();

    // esc to hide the search field
    if ( event.keyCode === 27 ) {
        jQuery('#sidebar_search').removeClass('active');

        const tagId = jQuery('#sidebar_search').parent().prop('id');
        jQuery_WPF('#'+tagId).removeClass('wpf_active').addClass('wpf_hide');
        jQuery_WPF('#sidebar_filters li > a[data-tag="' + tagId + '"]').removeClass('wpf_active');
        jQuery("#wpf_search_title").val('');

        search_filter('');
        return;
    }

    search_filter(task_title);
}


/**
 * Hide search from the sidebar by clicking on the search icon
 */
function hide_search_from_sidebar() {

    jQuery('#sidebar_search').removeClass('active');

    jQuery("#wpf_search_title").val('');

    const tagId = jQuery('#sidebar_search').parent().prop('id');
    jQuery_WPF('#'+tagId).removeClass('wpf_active').addClass('wpf_hide');
    jQuery_WPF('#sidebar_filters li > a[data-tag="' + tagId + '"]').removeClass('wpf_active');

    search_filter('');
}


/**
 * Resent the sidebar filter
 */
function reset_sidebar_filters() {

    jQuery("#sidebar_filters #wpf_side_filter > .wpf_list").each(function(index, element) {
        if ( jQuery(element).hasClass('wpf_active') ) {
            jQuery("#wpf_search_title").val("");

            const tagId = jQuery(element).prop('id');
            jQuery_WPF('#'+tagId).removeClass('wpf_active').addClass('wpf_hide');
            jQuery_WPF('#sidebar_filters li > a[data-tag="' + tagId + '"]').removeClass('wpf_active');
        }
    });
}


/**
 * Convert URLs in a string to anchor links
 * @param {!string} string
 * @returns {!string}
 */

function URLify(text){
    if ( typeof text !== "undefined" ) {
        const exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        const text1=text.replace(exp, "<a href='$1'>$1</a>");
        const exp2 =/(^|[^\/])(www\.[\S]+(\b|$))/gim;
        
        return text1.replace(exp2, '$1<a target="_blank" href="http://$2">$2</a>');
    }
    return text;
}


function is_video_Url(url) {
    var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
    var matches = url.match(p);
    if(matches){
        return matches[1];
    }
    
    return false;
}

function countdownTimeStartBackword(deadline, offset=0) {
    
    const countDownDate = deadline.getTime();

    // Update the count down every 1 second
    var x = setInterval(function () {const dateNow = new Date();
    
        // Get todays date and time
        var now = eval(new Date(
            dateNow.getUTCFullYear(),
            dateNow.getUTCMonth(),
            dateNow.getUTCDate(),
            dateNow.getUTCHours(),
            dateNow.getUTCMinutes(),
            dateNow.getUTCSeconds(),
            dateNow.getUTCMilliseconds()   
        ).getTime());

        // Find the distance between now an the count down date
        var distance = (countDownDate > now) 
        ? countDownDate - now
        : now - countDownDate;

        // Time calculations for days, hours, minutes and seconds
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor(
            (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

        if (countDownDate < now) {

             // add the nagetive sign (-) based on the deadline
            days    = ( (days > 0) && (countDownDate < now) ) ? `-${days}` : days;
            hours   = ( (days > 0 && days===0) && (countDownDate < now) ) ? `-${hours}` : hours;
            minutes = ( (minutes > 0 && hours===0 && days===0) && (countDownDate < now) ) ? `-${minutes}` : minutes;
        }

        // Output the result in an element with id="demo"
        const timer = `${days}d ${hours}h ${minutes}m`;
        jQuery_WPF('#wpf_site_milestone #wpf_countdown_timer').html(timer);
    
    }, 1000);
}


function start_milestone_timer(milestone)
{
    const date_time_str = `${milestone['due_date_at']} ${milestone['due_time_at']}`;    
    const deadline      = new Date(date_time_str);
    const now           = new Date();
    countdownTimeStartBackword(deadline);
}


// milestone popover
jQuery_WPF( document ).on( 'click', '#wpf_site_milestone', () => {

    const element = jQuery_WPF('#wpf_site_milestone');

    if( jQuery_WPF(element).next().hasClass('wpf_active'))
        jQuery_WPF(element).next().removeClass('wpf_active').addClass('wpf_hide');
    else {
        jQuery_WPF(element).next().removeClass('wpf_hide').addClass('wpf_active');

        const loader_html = `<div class="wpf_loader wpf_loader_3 wpf_active"></div>`;
        jQuery_WPF(element).next().html( loader_html );

        // fetch site's milestone API to list the phases (milestones)
        jQuery_WPF.ajax({
            url: ajaxurl,
            type: 'POST',
            data: {action:'wpf_fetch_milestones', wpf_nonce: wpf_nonce },
            beforeSend: function(){
            },
            success: function(data){
                const milestones = JSON.parse(data);

                let html = `<div class="wpf_milestone_item_container"><div class="wpf_milestone_item_container_header">`;
                html += `<label class="wpf_visibility_title">Project Stages</label>`; // title
                html += `<a href="javascript:void(0)" onclick="close_milestone_popup(this);" class="close" data-dismiss="alert">×</a></div>`; // close button

                jQuery_WPF.each(milestones['result'], function (key, milestone) {
                    let icon        = milestone_calender_icon;
                    let icon_class  = 'pending';

                    if ( milestone['is_active'] ) {
                        icon = milestone_calender_plus_icon;
                        icon_class = 'in_progress';
                    } else if ( milestone['status'] ) {
                        icon = milestone_calender_check_icon;
                        icon_class = 'done';
                    }
                    
                    html += `
                    <div class="wpf_milestone_item">
                        <ul ${milestone['status'] ? 'class="completed"' : ''}>                        
                            <li class="wpf_${icon_class}">
                                <span>${icon}</span>
                                ${milestone['title']}
                            </li>
                            <li>${milestone['days_left']}</li>
                        </ul>
                    </div>`;
                });

                html += `</div>`;

                jQuery_WPF(element).next().html( html );
            }
        });
    }
} );

// Show share popup by Pratap.
jQuery_WPF(document).on( 'click', '.wpf_share_btn', function() {
    if ( jQuery_WPF('.avc_invite_share_wrapper').length > 0 ) {
        jQuery_WPF('.avc_invite_share_wrapper').css('display', 'flex');
    }
});

// Hide share popup by Pratap.
jQuery_WPF(document).on( 'click', '.avc_close_share_container', function() {
    jQuery_WPF('.avc_invite_share_wrapper').hide();
});

// Copy to clipboard by Pratap.
function avc_copy_to_clipboard( id ) {
    var text_con = jQuery_WPF('#' + id).closest('.avc_share_button').find('.avc_copy_link_icon span');
    var init_text = text_con.text();
    var copyText = document.getElementById( id );
    copyText.select();
    copyText.setSelectionRange(0, 99999);
    document.execCommand("copy");

    text_con.text('Link Copied');
    setTimeout(function() {
        text_con.text(init_text);
    }, 1500);

    return false;
}

// Copy to clipboard by Pratap.
function avc_copypagelink_to_clipboard( id ) {
    var copyText = document.getElementById( id );
    copyText.select();
    copyText.setSelectionRange(0, 99999);
    document.execCommand("copy");

    jQuery_WPF('.avc_copy_pagelink').text('Copied');
    setTimeout(function() {
        jQuery_WPF('.avc_copy_pagelink').text('Copy');
    }, 1500);

    return false;
}

// Add row to invite more users by Pratap.
jQuery_WPF(document).on( 'click', '.avc_add_invite', function() {
    jQuery_WPF(this).closest('.avc_each_invite').after('<div class="avc_each_invite"><div class="avc_invite_fields"><input tpye="text" name="invite_name" class="avc_invite_name" placeholder="Full name" ><input type="email" name="invite_email" class="avc_invite_email" placeholder="Email address" ></div><div class="avc_add_remove_invite"><button class="avc_add_invite" tabindex="0" type="button"><svg class="avc_add_inivite_svg" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg></button><button class="avc_remove_invite" tabindex="0" type="button"><svg class="avc_remove_inivite_svg" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 13H5v-2h14v2z"></path></svg></button></div></div>');
    jQuery_WPF('.avc_remove_invite').css('visibility', 'visible');
});

// Remove unwanted row from invite by Pratap.
jQuery_WPF(document).on( 'click', '.avc_remove_invite', function() {
    jQuery_WPF(this).closest('.avc_each_invite').remove();
    if ( jQuery_WPF('.avc_each_invite').length < 2 ) {
        jQuery_WPF('.avc_remove_invite').css('visibility', 'hidden');
    }
});

// Validate email by Pratap.
function IsEmail(email) {
    var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    if ( !regex.test( email ) ) {
        return false;
    } else {
        return true;
    }
}

var is_empty = 1;
jQuery_WPF(document).on( 'change keyup', '.avc_invite_name, .avc_invite_email', function() {
    is_empty = 0;
    jQuery_WPF('.avc_invite_name, .avc_invite_email').each(function() {
        if( jQuery_WPF(this).val() == '' ) {
            is_empty = 1;
        }
    });
    if( is_empty == 1 ) {
        jQuery_WPF('#send_invite').removeClass('send_invite_active');
    } else {
        jQuery_WPF('#send_invite').addClass('send_invite_active');
    }
});

// Send invitation Share version 2 js by Pratap.
jQuery_WPF(document).on( 'click', '#send_invite', function() {
    jQuery_WPF('.avc_invite_error_msg1').hide();
    jQuery_WPF('.avc_invite_error_msg2').hide();
    jQuery_WPF('.avc_invite_error_msg3').hide();
    jQuery_WPF('.avc_invite_error_msg4').hide();
    jQuery_WPF('.avc_invite_name').removeClass('avc_red_border');
    jQuery_WPF('.avc_invite_email').removeClass('avc_red_border');
    if( is_empty == 0 ) {
        var user_data = [];
        jQuery_WPF('.avc_each_invite').each(function() {
            var name = jQuery_WPF('.avc_invite_name', this).val();
            var email = jQuery_WPF('.avc_invite_email', this).val();
            if ( email != '' ) {
                if ( IsEmail( email ) == true ) {
                    if ( name != '' ) {
                        if ( name.length >= 3 ) {
                            arr = [email, name];
                            user_data.push(arr);
                        } else {
                            jQuery_WPF('.avc_invite_error_msg3').show();
                            jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                            user_data = [];
                        }
                    } else {
                        jQuery_WPF('.avc_invite_error_msg1').show();
                        jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                        user_data = [];
                    }
                } else {
                    jQuery_WPF('.avc_invite_error_msg4').show();
                    jQuery_WPF('.avc_invite_email', this).addClass('avc_red_border');
                    if ( name != '' ) {
                        if ( name.length < 3 ) {
                            jQuery_WPF('.avc_invite_error_msg3').show();
                            jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                        }
                    } else {
                        jQuery_WPF('.avc_invite_error_msg1').show();
                        jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                    }
                    user_data = [];
                }
            } else {
                jQuery_WPF('.avc_invite_error_msg2').show();
                jQuery_WPF('.avc_invite_email', this).addClass('avc_red_border');
                if ( name != '' ) {
                    if ( name.length < 3 ) {
                        jQuery_WPF('.avc_invite_error_msg3').show();
                        jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                    }
                } else {
                    jQuery_WPF('.avc_invite_error_msg1').show();
                    jQuery_WPF('.avc_invite_name', this).addClass('avc_red_border');
                }
                user_data = [];
            }
        });
    }
    
    if ( user_data.length < 1 ) {
        jQuery_WPF('.avc_invite_error_container').animate({'right':'1px'}, 'slow');
        setTimeout(function() {
            jQuery_WPF('.avc_invite_error_container').animate({'right':'-375px'}, 'slow');
        }, 5000);
    }
    if ( user_data.length > 0 ) {
        var current_page  = jQuery_WPF('#avc_current_page').val();
        var site_title  = jQuery_WPF('#avc_site_title').val();
        jQuery_WPF.ajax({
            url: ajaxurl,
            type: 'POST',
            data: {
                action:'avc_send_invitations',
                wpf_nonce: wpf_nonce,
                user_data: user_data,
                current_page: current_page,
                site_title: site_title
            },
            beforeSend: function() {
                jQuery_WPF('.wpf_loader').show();
            },
            success: function( data ) {
                if ( data != '' ) {
                    data = JSON.parse( data );
                    if ( data.sent == 1 ) {
                        jQuery_WPF('.avc_invite_name').val('');
                        jQuery_WPF('.avc_invite_email').val('');
                        jQuery_WPF('.avc_invite_success').css('display', 'flex');
                        jQuery_WPF('.avc_suc_err_container').animate({'right':'1px'}, 'slow');
                        setTimeout(function() {
                            jQuery_WPF('.avc_suc_err_container').animate({'right':'-375px'}, 'slow', function() {
                                jQuery_WPF('.avc_invite_success').css('display', 'none');
                            });
                        }, 5000);
                        jQuery_WPF('.avc_each_invite').slice(1).remove();
                        jQuery_WPF('.avc_remove_invite').css('visibility', 'hidden');
                        if ( jQuery_WPF.isEmptyObject( data.success ) == false ) {
                            jQuery_WPF('.avc_shared_container').show();
                            var count = jQuery_WPF('.avc_shared_user_list .avc_invited_user').length;
                            count = count + 1;
                            jQuery_WPF.each( data.success, function( key, value ) {
                                var cloned = jQuery_WPF('.avc_hidden_user_structure .avc_invited_user').clone();
                                jQuery_WPF('.avc_ivi_user_img', cloned).html(value.initial);
                                jQuery_WPF('.avc_ivi_user_name', cloned).html('<span>' + value.name + '</span><br>' + value.email );
                                jQuery_WPF('.avc_delete_ivi_user', cloned).attr('data-id', value.id);
                                jQuery_WPF('.avc_share_page_link_input', cloned).attr('id', 'share_link_input' + count);
                                jQuery_WPF('.avc_share_page_link_input', cloned).attr('value', value.link);
                                jQuery_WPF('.avc_copy_link_icon', cloned).attr( 'onclick', 'avc_copy_to_clipboard(\'share_link_input' + count + '\')');
                                jQuery_WPF('.avc_shared_user_list').append(cloned);
                                cloned.hide().show('slow');
                                count = count + 1;
                            });
                        }
                    } else {
                        jQuery_WPF('.avc_invite_fail').css('display', 'flex');
                        jQuery_WPF('.avc_suc_err_container').animate({'right':'1px'}, 'slow');
                        setTimeout(function() {
                            jQuery_WPF('.avc_suc_err_container').animate({'right':'-375px'}, 'slow', function() {
                                jQuery_WPF('.avc_invite_fail').css('display', 'none');
                            });
                        }, 5000);
                    }
                }
                jQuery_WPF('.wpf_loader').hide();
            }
        });
    }
});

// Delete invitation Share version 2 js by Pratap.
jQuery_WPF(document).on( 'click', '.avc_delete_ivi_user', function() {
    if ( confirm( "Are you sure you want to delete this user? Deleting them from here will remove their WordPress user and their name from all tasks and comments they created." ) ) {
        var user_id = jQuery_WPF(this).data('id');
        var $this   = jQuery_WPF(this);
        if ( user_id > 0 ) {
            jQuery_WPF.ajax({
                url: ajaxurl,
                type: 'POST',
                data: {
                    action:'avc_delete_invitations',
                    wpf_nonce: wpf_nonce,
                    id: user_id,
                },
                beforeSend: function() {
                    jQuery_WPF('.wpf_loader').show();
                },
                success: function( data ) {
                    if ( data == 'true' ) {
                        $this.closest('.avc_invited_user').remove();
                        var count = jQuery_WPF('.avc_shared_user_list .avc_invited_user').length;
                        if ( count == 0 ) {
                            jQuery_WPF('.avc_shared_container').hide();
                        }
                        jQuery_WPF('.wpf_loader').hide();
                        jQuery_WPF('.avc_delete_success').css('display', 'flex');
                        jQuery_WPF('.avc_suc_err_container').animate({'right':'1px'}, 'slow');
                        setTimeout(function() {
                            jQuery_WPF('.avc_suc_err_container').animate({'right':'-375px'}, 'slow', function() {
                                jQuery_WPF('.avc_delete_success').css('display', 'none');
                            });
                        }, 5000);
                    }
                }
            });
        }
    }
});